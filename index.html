<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KOTR 2026 - King of the Road Avignon</title>
    <meta name="description" content="KOTR 2026 charity cycling event in Avignon, France supporting M√©decins Sans Fronti√®res. May 28 - June 1, 2026.">

    <!-- Mapbox GL JS -->
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
    <link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet">

    <!-- Turf.js for geospatial calculations -->
    <script src="https://unpkg.com/@turf/turf@6.5.0/turf.min.js"></script>

    <!-- Styles -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/mobile.css">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üö¥</text></svg>">
</head>
<body>
    <header class="hero">
        <div class="hero-content">
            <h1>KOTR 2026</h1>
            <p class="subtitle">King of the Road - Avignon</p>
            <p class="dates">May 28 - June 1, 2026</p>
            <div class="charity-badge">
                <span>Supporting</span>
                <strong>M√©decins Sans Fronti√®res</strong>
            </div>
        </div>
        <div class="hero-map" id="overview-map"></div>
    </header>

    <main>
        <section class="fundraising-banner">
            <div class="container">
                <p>Fundraising Target: <strong>¬£500 / ‚Ç¨550 / $600</strong> per rider</p>
                <a href="https://www.justgiving.com/page/eric-bowman-kotr26" target="_blank" rel="noopener" class="btn btn-primary">Donate to MSF</a>
            </div>
        </section>

        <!-- Trip Summary Bar -->
        <section class="trip-summary-bar" id="trip-summary-bar">
            <div class="container">
                <div class="trip-summary-content">
                    <div class="trip-summary-header">
                        <button class="rider-settings-btn" id="rider-settings-btn" title="Rider Profile">
                            <span class="settings-icon">‚öô</span>
                            <span class="settings-label">Rider Profile</span>
                        </button>
                        <h3 class="trip-summary-title">YOUR TRIP</h3>
                    </div>
                    <div class="trip-summary-stats">
                        <div class="summary-stat-item">
                            <span class="summary-stat-value" id="summary-days">4</span>
                            <span class="summary-stat-label">Days</span>
                        </div>
                        <div class="summary-stat-item">
                            <span class="summary-stat-value" id="summary-distance">--</span>
                            <span class="summary-stat-label">km total</span>
                        </div>
                        <div class="summary-stat-item">
                            <span class="summary-stat-value" id="summary-elevation">--</span>
                            <span class="summary-stat-label">m climbing</span>
                        </div>
                        <div class="summary-stat-item summary-time-estimate" id="summary-time-container" style="display: none;">
                            <span class="summary-stat-value" id="summary-time">--</span>
                            <span class="summary-stat-label" id="summary-time-label">@ 75% FTP</span>
                        </div>
                    </div>
                    <button class="btn btn-download-all" id="download-all-gpx">
                        <span class="icon">&#128229;</span> Download All GPX
                    </button>
                </div>
            </div>
        </section>

        <section class="profile-setup-prompt" id="profile-setup-prompt" hidden>
            <div class="container">
                <div class="profile-prompt-card">
                    <h3>Personalize Your Trip</h3>
                    <p class="profile-prompt-intro">Enter your weight and FTP to see personalized:</p>
                    <ul class="profile-prompt-benefits">
                        <li>Difficulty ratings for your fitness level</li>
                        <li>Estimated ride times at different efforts</li>
                        <li>Energy expenditure (kJ/calories)</li>
                        <li>Route recommendations</li>
                    </ul>
                    <div class="profile-prompt-actions">
                        <button type="button" class="btn btn-primary" id="profile-prompt-setup">Set Up Profile</button>
                        <button type="button" class="btn btn-secondary" id="profile-prompt-skip">Skip for now</button>
                    </div>
                </div>
            </div>
        </section>

        <section class="routes-section">
            <div class="container">
                <h2>Route Schedule</h2>
                <p class="routes-intro">Choose your adventure each day. Compare standard and long options at a glance.</p>

                <!-- Route cards are rendered dynamically from ROUTES config in main.js -->
                <!-- This ensures a single source of truth for all route statistics -->
                <!-- Stats are calculated from FIT files using DEM-based elevation matching Strava's algorithm -->
                <div class="route-cards" id="route-cards">
                    <!-- Loading placeholder - replaced by JS -->
                    <div class="route-cards-loading">Loading routes...</div>
                </div>

                <!-- Training Countdown Section -->
                <div class="training-countdown-section" id="training-countdown-section">
                    <h3 class="training-countdown-title">Training Countdown</h3>
                    <div class="training-countdown-content" id="training-countdown-content">
                        <!-- Content populated by JavaScript -->
                        <div class="training-loading">Calculating training plan...</div>
                    </div>
                </div>

                <!-- Route Comparison Table -->
                <div class="route-comparison-section" id="route-comparison-section">
                    <h3 class="comparison-title">Compare All Routes</h3>
                    <p class="comparison-subtitle">See the difference between taking all standard routes vs all long routes</p>
                    <div class="comparison-table-wrapper">
                        <table class="comparison-table" id="comparison-table">
                            <thead>
                                <tr>
                                    <th class="metric-col">Metric</th>
                                    <th class="option-col standard-col">
                                        <span class="col-label">All Standard</span>
                                        <span class="easier-badge" id="standard-easier-badge" hidden>Easier</span>
                                    </th>
                                    <th class="option-col long-col">
                                        <span class="col-label">All Long</span>
                                        <span class="harder-badge" id="long-harder-badge" hidden>More Challenge</span>
                                    </th>
                                    <th class="delta-col">Delta</th>
                                </tr>
                            </thead>
                            <tbody id="comparison-table-body">
                                <!-- Rows populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                    <p class="comparison-note" id="comparison-note">
                        <span class="note-icon">&#9432;</span>
                        <span id="comparison-note-text">Set up your rider profile to see personalized time and energy estimates.</span>
                    </p>
                </div>
            </div>
        </section>

        <section class="weather-section">
            <div class="container">
                <h2>Weather Forecast</h2>
                <p class="weather-subtitle">Avignon, France ‚Ä¢ Event Week</p>
                <div class="weather-widget" id="weather-widget">
                    <div class="weather-loading">Loading weather data...</div>
                </div>
            </div>
        </section>

        <section class="info-section">
            <div class="container">
                <div class="info-grid">
                    <div class="info-card">
                        <h3>üó∫Ô∏è About the Routes</h3>
                        <p>All routes start and end in Avignon. Download the GPX files for your bike computer, or experience them first in our 3D flyover.</p>
                    </div>
                    <div class="info-card">
                        <h3>üèîÔ∏è Mont Ventoux</h3>
                        <p>The "Beast of Provence" rises to 1,909m. The climb from B√©doin is 21.5km at 7.5% average. The last 6km above the tree line are legendary.</p>
                    </div>
                    <div class="info-card">
                        <h3>‚ù§Ô∏è M√©decins Sans Fronti√®res</h3>
                        <p>Every pedal stroke supports MSF's life-saving work. Doctors Without Borders provides medical care where it's needed most.</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>KOTR 2026 ‚Ä¢ Supporting <a href="https://www.msf.org/" target="_blank" rel="noopener">M√©decins Sans Fronti√®res</a></p>
            <p class="copyright">Made with ‚ù§Ô∏è for charity cycling</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="js/fit-parser.js"></script>
    <script src="js/weather-widget.js"></script>
    <script src="js/rider-profile.js"></script>
    <script src="js/power-calculator.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
